<!DOCTYPE html>
<html>
    <head>
        <title>
            Pat's "Rock, Paper, Scissors"
        </title>
    </head>
    <script>
        
        const ALLOWED_MOVES = ['rock', 'paper', 'scissors']
        const OUTCOMES = ["You lose!", "You win!", "It's a tie!"]

        function getRandomInt(max) { /* Gets random int for computer choice */
            return Math.floor(Math.random() * Math.floor(max));
        }

        function computerPlay() { /* Gets value that computer will play */
            let randomNum = getRandomInt(3);
            if (randomNum === 0) {return 'rock'}
            if (randomNum === 1) {return 'paper'}
            if (randomNum === 2) {return 'scissors'}
        }

        function compareSelections(selection1, selection2) { /*returns 0 if p1 loses, 1 if p1 wins, 2 if tie*/
            
            if (selection1.toLowerCase() === selection2.toLowerCase()) {
                return 2;
            }

            if ((selection1.toLowerCase() === 'rock' && selection2.toLowerCase() === 'scissors') || 
                (selection1.toLowerCase() === 'paper' && selection2.toLowerCase() === 'rock') || 
                (selection1.toLowerCase() === 'scissors' && selection2.toLowerCase() === 'paper')) 
                {return 1;}

            if ((selection2.toLowerCase() === 'rock' && selection1.toLowerCase() === 'scissors') || 
                (selection2.toLowerCase() === 'paper' && selection1.toLowerCase() === 'rock') || 
                (selection2.toLowerCase() === 'scissors' && selection1.toLowerCase() === 'paper')) 
                {return 0;}
        }



        function playRound(playerSelection, computerSelection) { /* Plays round of rock, paper, scissors. Returns 0 if lose, 1 if win, 2 if tie*/
            if ((compareSelections(playerSelection, computerSelection) === 0)) {
                return 0;
            }

            if ((compareSelections(playerSelection, computerSelection) === 1)) {
                return 1;
            }

            if ((compareSelections(playerSelection, computerSelection) === 2)) {
                return 2;
            }
        }

        function promptPlayerMove() { /* prompts user to enter move */
            let playerSelection = prompt("Enter your move");

            while (!ALLOWED_MOVES.includes(playerSelection.toLowerCase())) { /* checks for valid input */
                playerSelection = prompt("Invalid move! Choose rock, paper, or scissors.");
            }

            return playerSelection;
        }

        function getMoves() { /* gets both player and computer moves */
            return [promptPlayerMove(), computerPlay()]
        }

        function game() { /* Plays 5 rounds of rock, paper, scissors. */

            let score = {"player": 0, "computer": 0};
            
            for (let i = 1; i < 6; i++) {

                let round_outcome = null;
                moves = getMoves();

                if (playRound(moves[0], moves[1]) == 0) {
                    score["computer"] += 1;
                    round_outcome = 0
                } else if (playRound(moves[0], moves[1]) == 1) {
                    score["player"] += 1;
                    round_outcome = 1
                } else if (playRound(moves[0], moves[1]) == 2) {
                    round_outcome = 2
                } else {
                    alert("Something went horribly wrong..");
                    return -1;
                }


                alert("Round " + i + ": \nComputer picked " + moves[1] + "\n" + OUTCOMES[round_outcome] + "\nPlayer points: " + score["player"] + "\nComputer points: " + score["computer"]);

            }

            if (score["player"] < score["computer"]) {
                alert("Game set: You lose!");
            } else if (score["player"] > score["computer"]) {
                alert("Game set: You win!");
            } else if (score["player"] == score["computer"]) {
                alert("Game set: It's a tie!");
            } else {
                alert("FATAL ERROR");
            }
        }


        game();
        
    </script>
</html>